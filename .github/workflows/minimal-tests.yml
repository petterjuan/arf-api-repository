- name: Validate core imports
  run: |
    echo "Validating core imports..."
    cat > validate_imports.py << 'EOF'
    import sys
    import os
    
    # Set environment variables BEFORE any imports
    os.environ['SKIP_DATABASE_INIT'] = '1'
    os.environ['TESTING'] = '1'
    os.environ['VALIDATION_MODE'] = '1'
    
    # Add src to path
    src_path = os.path.join(os.getcwd(), 'src')
    sys.path.insert(0, src_path)
    
    print("=" * 60)
    print("ARF API Import Validation")
    print("=" * 60)
    
    # Test 1: Core application
    try:
        from main import app
        print("✅ PASS: main.py imports successfully")
        print(f"   - Found FastAPI app with {len(app.routes)} routes")
        
        # Check for critical endpoints
        routes = [route.path for route in app.routes]
        critical_endpoints = ['/health', '/docs', '/openapi.json', '/metrics']
        for endpoint in critical_endpoints:
            if any(endpoint in route for route in routes):
                print(f"   - Found endpoint: {endpoint}")
    except Exception as e:
        print(f"❌ FAIL: main.py import failed: {e}")
        import traceback
        traceback.print_exc()
        sys.exit(1)
    
    # Rest of validation tests...
    EOF
    
    python validate_imports.py
