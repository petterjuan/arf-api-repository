# ============================================================================
# PYTEST CONFIGURATION - CLEAN AND EFFECTIVE
# ============================================================================

[pytest]

# Clear test discovery
testpaths = tests
python_files = test_*.py *_test.py
python_classes = Test*
python_functions = test_*

# Async tests that work
asyncio_mode = auto

# ----------------------------------------------------------------------------
# TEST EXECUTION OPTIONS
# ----------------------------------------------------------------------------
addopts = 
    -v
    --tb=short
    --strict-markers
    --disable-warnings
    -p no:warnings
    --import-mode=importlib
    --show-capture=no
    --color=yes
    --durations=10
    --maxfail=3

# ----------------------------------------------------------------------------
# TEST MARKERS - CLEAR CATEGORIES
# ----------------------------------------------------------------------------
markers =
    unit: Fast, focused tests without external dependencies
    integration: Tests requiring external services
    slow: Tests that take significant time to run
    auth: Authentication and authorization tests
    database: Database interaction tests
    requires_respx: Tests using HTTP mocking
    confidence_builder: Tests that give quick validation
    risk_mitigation: Tests for critical failure scenarios
    refactor_safe: Tests that allow implementation changes

# ----------------------------------------------------------------------------
# WARNING MANAGEMENT
# ----------------------------------------------------------------------------
filterwarnings =
    ignore::DeprecationWarning
    ignore::UserWarning
    ignore::pytest.PytestUnhandledThreadExceptionWarning
    ignore::FutureWarning
    ignore::ResourceWarning
