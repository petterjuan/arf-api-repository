# ============================================================================
# PYTEST CONFIGURATION - CLEAN AND EFFECTIVE
# ============================================================================
# Single source of truth for test configuration
# No conflicts, no confusion
# ============================================================================

[pytest]

# Clear test discovery - no guessing
testpaths = tests
python_files = test_*.py *_test.py
python_classes = Test*
python_functions = test_*

# Async tests that work without frustration
asyncio_mode = auto

# ----------------------------------------------------------------------------
# OPTIONS THAT GET STRAIGHT TO THE POINT
# ----------------------------------------------------------------------------
addopts = 
    -v                       # Verbose output - see what's happening
    --tb=short               # Clean tracebacks - understand errors quickly
    --strict-markers         # Prevent marker typos that cause confusion
    --disable-warnings       # Focus on what matters, not noise
    -p no:warnings          # Additional noise reduction
    --import-mode=importlib  # Prevent duplicate plugin registration
    --show-capture=no        # Clean output without clutter
    --color=yes              # Visual success/failure indicators
    --durations=10           # Identify slow tests for optimization
    --maxfail=3              # Fail fast when things go wrong

# ----------------------------------------------------------------------------
# TEST CATEGORIES - CLEAR AND USEFUL
# ----------------------------------------------------------------------------
markers =
    # Core test types
    unit: Fast, focused tests without external dependencies
    integration: Tests requiring external services
    slow: Tests that take significant time to run
    
    # Domain-specific tests
    auth: Authentication and authorization tests
    database: Database interaction tests
    requires_respx: Tests using HTTP mocking
    
    # Development helpers
    confidence_builder: Tests that give quick validation
    risk_mitigation: Tests for critical failure scenarios
    refactor_safe: Tests that allow implementation changes

# ----------------------------------------------------------------------------
# WARNING MANAGEMENT - KEEP THE SIGNAL CLEAR
# ----------------------------------------------------------------------------
filterwarnings =
    ignore::DeprecationWarning
    ignore::UserWarning
    ignore::pytest.PytestUnhandledThreadExceptionWarning
    ignore::FutureWarning
    ignore::ResourceWarning
